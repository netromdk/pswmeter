// pswmeter @ https://github.com/netromdk/pswmeter (MIT License)
"use strict";function hasLocalStorage(){try{var a="123";return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(b){return!1}}function Psw(a){this.loadPath=a||"wordlist.json",this.wordlist=[];var b=this,c=hasLocalStorage();if(c&&null!=localStorage.psw_wordlist){try{var d=JSON.parse(localStorage.psw_wordlist)}catch(e){return void console.log("Error parsing localStorage value: "+e)}b.wordlist=d.wordlist,console.log("Loaded wordlist from local storage!")}else $.ajax({type:"GET",url:b.loadPath,success:function(a){if("string"==typeof a)try{a=JSON.parse(a)}catch(d){return void console.log("Error parsing data read: "+d)}b.wordlist=a.wordlist,c&&(localStorage.psw_wordlist=JSON.stringify(a)),console.log('Loaded wordlist from "'+b.loadPath+'"')},error:function(a,c,d){console.log("Error loading '"+b.loadPath+"': "+d)}})}window.Psw=Psw,Psw.prototype.analyze=function(a){var b=this.calcScore(a),c=this.scoreMeaning(b);return{score:b,meaning:c[0],color:c[1]}},Psw.prototype.analyze=Psw.prototype.analyze,Psw.prototype.calcScore=function(a){return void 0==a||0==a.length?0:Math.max(this.calcBasic16(a),this.calcComp8(a))},Psw.prototype.calcScore=Psw.prototype.calcScore,Psw.prototype.scoreMeaning=function(a){return a>0&&16>=a?["Dreadful","#FF0000"]:a>16&&33>=a?["Bad","#FF6600"]:a>33&&50>=a?["Poor","#FF9900"]:a>50&&67>=a?["Fair","#FFCC00"]:a>67&&84>=a?["Good","#FFFF00"]:a>84&&99>=a?["Great","#CCFF00"]:a>99&&115>=a?["Excellent","#99FF00"]:a>115?["Fantastic","#00FF00"]:["",""]},Psw.prototype.scoreMeaning=Psw.prototype.scoreMeaning,Psw.prototype.calcBasic16=function(a){var b=0,c=a.length;return b=4*Math.min(c,7),c>7&&(b+=8*(c-7)),b},Psw.prototype.calcBasic16=Psw.prototype.calcBasic16,Psw.prototype.calcComp8=function(a){function b(a){return(a>=1?17:0)+(a>=2?8:0)+(a>=3?4:0)}var c=0,d=a.length,e=this.countCmp(a,this.isUpper,!0),f=this.countCmp(a,this.isDigit,!0),g=this.countCmp(a,this.isSymbol,!0),h=this.countCmp(a,this.isLower);return c=4*d,c+=b(e)+b(f)+b(g),0==h&&(c-=17),this.checkWordList(a)&&(c+=17),c},Psw.prototype.calcComp8=Psw.prototype.calcComp8,Psw.prototype.isUpper=function(a){return XRegExp("^\\p{Lu}$").test(a)},Psw.prototype.isUpper=Psw.prototype.isUpper,Psw.prototype.isLower=function(a){return XRegExp("^\\p{Ll}$").test(a)},Psw.prototype.isLower=Psw.prototype.isLower,Psw.prototype.isDigit=function(a){return/^\d$/.test(a)},Psw.prototype.isDigit=Psw.prototype.isDigit,Psw.prototype.isSymbol=function(a){return/^[!=\?\"\'#%\$§\/\\\(\)\[\]{}+\-\.,;:_<>\*`´\^~|]$/.test(a)},Psw.prototype.isSymbol=Psw.prototype.isSymbol,Psw.prototype.countCmp=function(a,b,c){void 0==c&&(c=!1);var d=0,e=a.split("");return c&&(e=$.unique(e.sort())),$.each(e,function(a){b(e[a])&&d++}),d},Psw.prototype.countCmp=Psw.prototype.countCmp,Psw.prototype.checkWordList=function(a){return-1==this.wordlist.indexOf(a.toLowerCase())},Psw.prototype.checkWordList=Psw.prototype.checkWordList;